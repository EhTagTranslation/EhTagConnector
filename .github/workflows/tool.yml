name: build tool

on: [push]

jobs:
  build:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v1
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: 3.0.100
    - name: make
      shell: powershell
      run: |
        dotnet publish .\EhDbReleaseBuilder\ --configuration Release -o ./publish
        Compress-Archive .\publish\* release.zip -Force
    - uses: ncipollo/release-action@v1
      with:
        artifacts: release.zip
        token: ${{ secrets.GITHUB_TOKEN }}
        commit: ${{ github.sha }}
        tag: ${{ format('v-{0}', github.sha) }}
        name: ${{ github.event.head_commit.message }}
